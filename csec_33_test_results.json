{
  "findings": [
    {
      "pattern_id": "csec_33_missing_rls",
      "pattern_name": "Missing PostgreSQL Row-Level Security (RLS)",
      "file": "tests\\test_sample_missing_rls_settings.py",
      "line": 26,
      "matched_code": "MIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',\n    'django.contrib.sessions.middleware.SessionMiddleware',\n    'django.middleware.common.CommonMiddleware',\n    'django.middleware.csrf.CsrfViewMiddleware',\n    'django.contrib.auth.middleware.AuthenticationMiddleware',\n    # 'middleware.tenant_rls.TenantRLSMiddleware',  # MISSING!\n    'django.contrib.messages.middleware.MessageMiddleware',\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',\n]",
      "language": "python",
      "severity": "critical",
      "category": "database_security",
      "description": "MIDDLEWARE without RLS tenant context middleware",
      "metadata": {
        "variable_name": "UNKNOWN",
        "env_var_name": "UNKNOWN",
        "original_fallback": "'default'",
        "context_analysis": {}
      },
      "jira_reference": {
        "ticket": "CSEC-33",
        "epic": "CSEC-7",
        "project": "Coco TestAI Security Remediation"
      },
      "fix_strategy": {
        "approach": "database_rls_implementation",
        "breaking_change": false,
        "description": "Implement PostgreSQL Row-Level Security (RLS) for tenant isolation:\n\n1. Enable RLS on all tenant-scoped tables\n2. Create RLS policies to filter by current_tenant_id\n3. Add middleware to set app.current_tenant_id on each request\n4. Configure migration/superuser to bypass RLS\n5. Add integration tests for cross-tenant isolation\n\nThis is a non-breaking addition that provides defense-in-depth security.\n",
        "phases": [
          {
            "name": "discovery",
            "duration_days": 0,
            "description": "Identify all models with tenant FK"
          },
          {
            "name": "migration_creation",
            "duration_days": 1,
            "description": "Create migration to enable RLS and policies"
          },
          {
            "name": "middleware_implementation",
            "duration_days": 1,
            "description": "Create and configure tenant context middleware"
          },
          {
            "name": "user_configuration",
            "duration_days": 0,
            "description": "Configure migration user to bypass RLS"
          },
          {
            "name": "testing",
            "duration_days": 2,
            "description": "Write and run integration tests"
          },
          {
            "name": "validation",
            "duration_days": 1,
            "description": "Verify cross-tenant isolation in production-like environment"
          }
        ]
      }
    },
    {
      "pattern_id": "csec_33_missing_rls",
      "pattern_name": "Missing PostgreSQL Row-Level Security (RLS)",
      "file": "tests\\test_sample_missing_rls_settings.py",
      "line": 38,
      "matched_code": "DATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.postgresql',\n        'NAME': 'testdb',\n        'USER': 'app_user',  # Should be checked if it has BYPASSRLS\n        'PASSWORD': 'password',\n        'HOST': 'localhost',\n        'PORT': '5432',\n    }",
      "language": "python",
      "severity": "critical",
      "category": "database_security",
      "description": "DATABASES configuration (check for RLS setup)",
      "metadata": {
        "variable_name": "UNKNOWN",
        "env_var_name": "UNKNOWN",
        "original_fallback": "'default'",
        "context_analysis": {}
      },
      "jira_reference": {
        "ticket": "CSEC-33",
        "epic": "CSEC-7",
        "project": "Coco TestAI Security Remediation"
      },
      "fix_strategy": {
        "approach": "database_rls_implementation",
        "breaking_change": false,
        "description": "Implement PostgreSQL Row-Level Security (RLS) for tenant isolation:\n\n1. Enable RLS on all tenant-scoped tables\n2. Create RLS policies to filter by current_tenant_id\n3. Add middleware to set app.current_tenant_id on each request\n4. Configure migration/superuser to bypass RLS\n5. Add integration tests for cross-tenant isolation\n\nThis is a non-breaking addition that provides defense-in-depth security.\n",
        "phases": [
          {
            "name": "discovery",
            "duration_days": 0,
            "description": "Identify all models with tenant FK"
          },
          {
            "name": "migration_creation",
            "duration_days": 1,
            "description": "Create migration to enable RLS and policies"
          },
          {
            "name": "middleware_implementation",
            "duration_days": 1,
            "description": "Create and configure tenant context middleware"
          },
          {
            "name": "user_configuration",
            "duration_days": 0,
            "description": "Configure migration user to bypass RLS"
          },
          {
            "name": "testing",
            "duration_days": 2,
            "description": "Write and run integration tests"
          },
          {
            "name": "validation",
            "duration_days": 1,
            "description": "Verify cross-tenant isolation in production-like environment"
          }
        ]
      }
    },
    {
      "pattern_id": "csec_33_missing_rls",
      "pattern_name": "Missing PostgreSQL Row-Level Security (RLS)",
      "file": "tests\\test_sample_missing_rls_models.py",
      "line": 10,
      "matched_code": "class Document(models.Model):\n    \"\"\"Document model with tenant_id - needs RLS\"\"\"\n    tenant_id = models.",
      "language": "python",
      "severity": "critical",
      "category": "database_security",
      "description": "Model with tenant_id field (may need RLS)",
      "metadata": {
        "variable_name": "UNKNOWN",
        "env_var_name": "UNKNOWN",
        "original_fallback": "'default'",
        "context_analysis": {}
      },
      "jira_reference": {
        "ticket": "CSEC-33",
        "epic": "CSEC-7",
        "project": "Coco TestAI Security Remediation"
      },
      "fix_strategy": {
        "approach": "database_rls_implementation",
        "breaking_change": false,
        "description": "Implement PostgreSQL Row-Level Security (RLS) for tenant isolation:\n\n1. Enable RLS on all tenant-scoped tables\n2. Create RLS policies to filter by current_tenant_id\n3. Add middleware to set app.current_tenant_id on each request\n4. Configure migration/superuser to bypass RLS\n5. Add integration tests for cross-tenant isolation\n\nThis is a non-breaking addition that provides defense-in-depth security.\n",
        "phases": [
          {
            "name": "discovery",
            "duration_days": 0,
            "description": "Identify all models with tenant FK"
          },
          {
            "name": "migration_creation",
            "duration_days": 1,
            "description": "Create migration to enable RLS and policies"
          },
          {
            "name": "middleware_implementation",
            "duration_days": 1,
            "description": "Create and configure tenant context middleware"
          },
          {
            "name": "user_configuration",
            "duration_days": 0,
            "description": "Configure migration user to bypass RLS"
          },
          {
            "name": "testing",
            "duration_days": 2,
            "description": "Write and run integration tests"
          },
          {
            "name": "validation",
            "duration_days": 1,
            "description": "Verify cross-tenant isolation in production-like environment"
          }
        ]
      }
    },
    {
      "pattern_id": "csec_33_missing_rls",
      "pattern_name": "Missing PostgreSQL Row-Level Security (RLS)",
      "file": "tests\\test_sample_missing_rls_models.py",
      "line": 10,
      "matched_code": "class Document(models.Model):\n    \"\"\"Document model with tenant_id - needs RLS\"\"\"\n    tenant_id = models.IntegerField()\n    title = models.CharField(max_length=200)\n    content = models.TextField()\n    created_at = models.DateTimeField(auto_now_add=True)\n\n    class Meta:\n        db_table = 'app_document'\n\n\n# Test Case 2: Model with tenant ForeignKey (should detect)\nclass Comment(models.Model):\n    \"\"\"Comment model with tenant FK - needs RLS\"\"\"\n    tenant = models.ForeignKey",
      "language": "python",
      "severity": "critical",
      "category": "database_security",
      "description": "Model with tenant/organization FK (may need RLS)",
      "metadata": {
        "variable_name": "tenant",
        "env_var_name": "tenant",
        "original_fallback": "'default'",
        "context_analysis": {}
      },
      "jira_reference": {
        "ticket": "CSEC-33",
        "epic": "CSEC-7",
        "project": "Coco TestAI Security Remediation"
      },
      "fix_strategy": {
        "approach": "database_rls_implementation",
        "breaking_change": false,
        "description": "Implement PostgreSQL Row-Level Security (RLS) for tenant isolation:\n\n1. Enable RLS on all tenant-scoped tables\n2. Create RLS policies to filter by current_tenant_id\n3. Add middleware to set app.current_tenant_id on each request\n4. Configure migration/superuser to bypass RLS\n5. Add integration tests for cross-tenant isolation\n\nThis is a non-breaking addition that provides defense-in-depth security.\n",
        "phases": [
          {
            "name": "discovery",
            "duration_days": 0,
            "description": "Identify all models with tenant FK"
          },
          {
            "name": "migration_creation",
            "duration_days": 1,
            "description": "Create migration to enable RLS and policies"
          },
          {
            "name": "middleware_implementation",
            "duration_days": 1,
            "description": "Create and configure tenant context middleware"
          },
          {
            "name": "user_configuration",
            "duration_days": 0,
            "description": "Configure migration user to bypass RLS"
          },
          {
            "name": "testing",
            "duration_days": 2,
            "description": "Write and run integration tests"
          },
          {
            "name": "validation",
            "duration_days": 1,
            "description": "Verify cross-tenant isolation in production-like environment"
          }
        ]
      }
    },
    {
      "pattern_id": "csec_33_missing_rls",
      "pattern_name": "Missing PostgreSQL Row-Level Security (RLS)",
      "file": "tests\\test_sample_missing_rls_models.py",
      "line": 34,
      "matched_code": "class Project(models.Model):\n    \"\"\"Project model with organization FK - needs RLS\"\"\"\n    organization = models.ForeignKey",
      "language": "python",
      "severity": "critical",
      "category": "database_security",
      "description": "Model with tenant/organization FK (may need RLS)",
      "metadata": {
        "variable_name": "organization",
        "env_var_name": "organization",
        "original_fallback": "'default'",
        "context_analysis": {}
      },
      "jira_reference": {
        "ticket": "CSEC-33",
        "epic": "CSEC-7",
        "project": "Coco TestAI Security Remediation"
      },
      "fix_strategy": {
        "approach": "database_rls_implementation",
        "breaking_change": false,
        "description": "Implement PostgreSQL Row-Level Security (RLS) for tenant isolation:\n\n1. Enable RLS on all tenant-scoped tables\n2. Create RLS policies to filter by current_tenant_id\n3. Add middleware to set app.current_tenant_id on each request\n4. Configure migration/superuser to bypass RLS\n5. Add integration tests for cross-tenant isolation\n\nThis is a non-breaking addition that provides defense-in-depth security.\n",
        "phases": [
          {
            "name": "discovery",
            "duration_days": 0,
            "description": "Identify all models with tenant FK"
          },
          {
            "name": "migration_creation",
            "duration_days": 1,
            "description": "Create migration to enable RLS and policies"
          },
          {
            "name": "middleware_implementation",
            "duration_days": 1,
            "description": "Create and configure tenant context middleware"
          },
          {
            "name": "user_configuration",
            "duration_days": 0,
            "description": "Configure migration user to bypass RLS"
          },
          {
            "name": "testing",
            "duration_days": 2,
            "description": "Write and run integration tests"
          },
          {
            "name": "validation",
            "duration_days": 1,
            "description": "Verify cross-tenant isolation in production-like environment"
          }
        ]
      }
    },
    {
      "pattern_id": "csec_33_missing_rls",
      "pattern_name": "Missing PostgreSQL Row-Level Security (RLS)",
      "file": "tests\\test_sample_missing_throttling_settings.py",
      "line": 28,
      "matched_code": "MIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',\n    'django.contrib.sessions.middleware.SessionMiddleware',\n    'django.middleware.common.CommonMiddleware',\n    'django.middleware.csrf.CsrfViewMiddleware',\n    'django.contrib.auth.middleware.AuthenticationMiddleware',\n    'django.contrib.messages.middleware.MessageMiddleware',\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',\n]",
      "language": "python",
      "severity": "critical",
      "category": "database_security",
      "description": "MIDDLEWARE without RLS tenant context middleware",
      "metadata": {
        "variable_name": "UNKNOWN",
        "env_var_name": "UNKNOWN",
        "original_fallback": "'default'",
        "context_analysis": {}
      },
      "jira_reference": {
        "ticket": "CSEC-33",
        "epic": "CSEC-7",
        "project": "Coco TestAI Security Remediation"
      },
      "fix_strategy": {
        "approach": "database_rls_implementation",
        "breaking_change": false,
        "description": "Implement PostgreSQL Row-Level Security (RLS) for tenant isolation:\n\n1. Enable RLS on all tenant-scoped tables\n2. Create RLS policies to filter by current_tenant_id\n3. Add middleware to set app.current_tenant_id on each request\n4. Configure migration/superuser to bypass RLS\n5. Add integration tests for cross-tenant isolation\n\nThis is a non-breaking addition that provides defense-in-depth security.\n",
        "phases": [
          {
            "name": "discovery",
            "duration_days": 0,
            "description": "Identify all models with tenant FK"
          },
          {
            "name": "migration_creation",
            "duration_days": 1,
            "description": "Create migration to enable RLS and policies"
          },
          {
            "name": "middleware_implementation",
            "duration_days": 1,
            "description": "Create and configure tenant context middleware"
          },
          {
            "name": "user_configuration",
            "duration_days": 0,
            "description": "Configure migration user to bypass RLS"
          },
          {
            "name": "testing",
            "duration_days": 2,
            "description": "Write and run integration tests"
          },
          {
            "name": "validation",
            "duration_days": 1,
            "description": "Verify cross-tenant isolation in production-like environment"
          }
        ]
      }
    },
    {
      "pattern_id": "csec_33_missing_rls",
      "pattern_name": "Missing PostgreSQL Row-Level Security (RLS)",
      "file": "tests\\test_sample_missing_throttling_settings.py",
      "line": 41,
      "matched_code": "DATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.postgresql',\n        'NAME': 'mydb',\n        'USER': 'myuser',\n        'PASSWORD': os.environ.get('DB_PASSWORD'),\n        'HOST': 'localhost',\n        'PORT': '5432',\n    }",
      "language": "python",
      "severity": "critical",
      "category": "database_security",
      "description": "DATABASES configuration (check for RLS setup)",
      "metadata": {
        "variable_name": "UNKNOWN",
        "env_var_name": "UNKNOWN",
        "original_fallback": "'default'",
        "context_analysis": {}
      },
      "jira_reference": {
        "ticket": "CSEC-33",
        "epic": "CSEC-7",
        "project": "Coco TestAI Security Remediation"
      },
      "fix_strategy": {
        "approach": "database_rls_implementation",
        "breaking_change": false,
        "description": "Implement PostgreSQL Row-Level Security (RLS) for tenant isolation:\n\n1. Enable RLS on all tenant-scoped tables\n2. Create RLS policies to filter by current_tenant_id\n3. Add middleware to set app.current_tenant_id on each request\n4. Configure migration/superuser to bypass RLS\n5. Add integration tests for cross-tenant isolation\n\nThis is a non-breaking addition that provides defense-in-depth security.\n",
        "phases": [
          {
            "name": "discovery",
            "duration_days": 0,
            "description": "Identify all models with tenant FK"
          },
          {
            "name": "migration_creation",
            "duration_days": 1,
            "description": "Create migration to enable RLS and policies"
          },
          {
            "name": "middleware_implementation",
            "duration_days": 1,
            "description": "Create and configure tenant context middleware"
          },
          {
            "name": "user_configuration",
            "duration_days": 0,
            "description": "Configure migration user to bypass RLS"
          },
          {
            "name": "testing",
            "duration_days": 2,
            "description": "Write and run integration tests"
          },
          {
            "name": "validation",
            "duration_days": 1,
            "description": "Verify cross-tenant isolation in production-like environment"
          }
        ]
      }
    },
    {
      "pattern_id": "csec_33_missing_rls",
      "pattern_name": "Missing PostgreSQL Row-Level Security (RLS)",
      "file": "tests\\test_sample_drf_settings.py",
      "line": 28,
      "matched_code": "MIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',\n    'django.contrib.sessions.middleware.SessionMiddleware',\n    'django.middleware.common.CommonMiddleware',\n    'django.middleware.csrf.CsrfViewMiddleware',\n    'django.contrib.auth.middleware.AuthenticationMiddleware',\n    'django.contrib.messages.middleware.MessageMiddleware',\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',\n]",
      "language": "python",
      "severity": "critical",
      "category": "database_security",
      "description": "MIDDLEWARE without RLS tenant context middleware",
      "metadata": {
        "variable_name": "UNKNOWN",
        "env_var_name": "UNKNOWN",
        "original_fallback": "'default'",
        "context_analysis": {}
      },
      "jira_reference": {
        "ticket": "CSEC-33",
        "epic": "CSEC-7",
        "project": "Coco TestAI Security Remediation"
      },
      "fix_strategy": {
        "approach": "database_rls_implementation",
        "breaking_change": false,
        "description": "Implement PostgreSQL Row-Level Security (RLS) for tenant isolation:\n\n1. Enable RLS on all tenant-scoped tables\n2. Create RLS policies to filter by current_tenant_id\n3. Add middleware to set app.current_tenant_id on each request\n4. Configure migration/superuser to bypass RLS\n5. Add integration tests for cross-tenant isolation\n\nThis is a non-breaking addition that provides defense-in-depth security.\n",
        "phases": [
          {
            "name": "discovery",
            "duration_days": 0,
            "description": "Identify all models with tenant FK"
          },
          {
            "name": "migration_creation",
            "duration_days": 1,
            "description": "Create migration to enable RLS and policies"
          },
          {
            "name": "middleware_implementation",
            "duration_days": 1,
            "description": "Create and configure tenant context middleware"
          },
          {
            "name": "user_configuration",
            "duration_days": 0,
            "description": "Configure migration user to bypass RLS"
          },
          {
            "name": "testing",
            "duration_days": 2,
            "description": "Write and run integration tests"
          },
          {
            "name": "validation",
            "duration_days": 1,
            "description": "Verify cross-tenant isolation in production-like environment"
          }
        ]
      }
    },
    {
      "pattern_id": "csec_33_missing_rls",
      "pattern_name": "Missing PostgreSQL Row-Level Security (RLS)",
      "file": "tests\\test_sample_drf_settings.py",
      "line": 41,
      "matched_code": "DATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.postgresql',\n        'NAME': 'mydb',\n        'USER': 'myuser',\n        'PASSWORD': os.environ.get('DB_PASSWORD'),\n        'HOST': 'localhost',\n        'PORT': '5432',\n    }",
      "language": "python",
      "severity": "critical",
      "category": "database_security",
      "description": "DATABASES configuration (check for RLS setup)",
      "metadata": {
        "variable_name": "UNKNOWN",
        "env_var_name": "UNKNOWN",
        "original_fallback": "'default'",
        "context_analysis": {}
      },
      "jira_reference": {
        "ticket": "CSEC-33",
        "epic": "CSEC-7",
        "project": "Coco TestAI Security Remediation"
      },
      "fix_strategy": {
        "approach": "database_rls_implementation",
        "breaking_change": false,
        "description": "Implement PostgreSQL Row-Level Security (RLS) for tenant isolation:\n\n1. Enable RLS on all tenant-scoped tables\n2. Create RLS policies to filter by current_tenant_id\n3. Add middleware to set app.current_tenant_id on each request\n4. Configure migration/superuser to bypass RLS\n5. Add integration tests for cross-tenant isolation\n\nThis is a non-breaking addition that provides defense-in-depth security.\n",
        "phases": [
          {
            "name": "discovery",
            "duration_days": 0,
            "description": "Identify all models with tenant FK"
          },
          {
            "name": "migration_creation",
            "duration_days": 1,
            "description": "Create migration to enable RLS and policies"
          },
          {
            "name": "middleware_implementation",
            "duration_days": 1,
            "description": "Create and configure tenant context middleware"
          },
          {
            "name": "user_configuration",
            "duration_days": 0,
            "description": "Configure migration user to bypass RLS"
          },
          {
            "name": "testing",
            "duration_days": 2,
            "description": "Write and run integration tests"
          },
          {
            "name": "validation",
            "duration_days": 1,
            "description": "Verify cross-tenant isolation in production-like environment"
          }
        ]
      }
    }
  ],
  "summary": {
    "total_count": 9,
    "model_findings": 3,
    "middleware_findings": 3,
    "database_findings": 3,
    "migration_findings": 0
  }
}