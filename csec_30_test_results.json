{
  "findings": [
    {
      "pattern_id": "csec_30_missing_permissions_policy",
      "pattern_name": "Missing Permissions-Policy Header",
      "file": "tests\\test_sample_drf_settings.py",
      "line": 28,
      "matched_code": "MIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',\n    'django.contrib.sessions.middleware.SessionMiddleware',\n    'django.middleware.common.CommonMiddleware',\n    'django.middleware.csrf.CsrfViewMiddleware',\n    'django.contrib.auth.middleware.AuthenticationMiddleware',\n    'django.contrib.messages.middleware.MessageMiddleware',\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',\n]",
      "language": "python",
      "severity": "medium",
      "category": "security_headers",
      "description": "MIDDLEWARE without permissions_policy middleware",
      "metadata": {
        "variable_name": "UNKNOWN",
        "env_var_name": "UNKNOWN",
        "original_fallback": "'default'",
        "context_analysis": {}
      },
      "jira_reference": {
        "ticket": "CSEC-30",
        "epic": "CSEC-5",
        "project": "Coco TestAI Security Remediation"
      },
      "fix_strategy": {
        "approach": "middleware_addition",
        "breaking_change": false,
        "description": "Add custom Django middleware that injects Permissions-Policy header\ninto all HTTP responses. This is a non-breaking addition that restricts\nbrowser features based on application needs.\n",
        "phases": [
          {
            "name": "detection",
            "duration_days": 0,
            "description": "Scan for missing Permissions-Policy configuration"
          },
          {
            "name": "middleware_creation",
            "duration_days": 0,
            "description": "Create custom permissions_policy middleware"
          },
          {
            "name": "configuration",
            "duration_days": 0,
            "description": "Add middleware to MIDDLEWARE list"
          },
          {
            "name": "testing",
            "duration_days": 1,
            "description": "Verify header appears in responses"
          }
        ]
      }
    },
    {
      "pattern_id": "csec_30_missing_permissions_policy",
      "pattern_name": "Missing Permissions-Policy Header",
      "file": "tests\\test_sample_missing_throttling_settings.py",
      "line": 28,
      "matched_code": "MIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',\n    'django.contrib.sessions.middleware.SessionMiddleware',\n    'django.middleware.common.CommonMiddleware',\n    'django.middleware.csrf.CsrfViewMiddleware',\n    'django.contrib.auth.middleware.AuthenticationMiddleware',\n    'django.contrib.messages.middleware.MessageMiddleware',\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',\n]",
      "language": "python",
      "severity": "medium",
      "category": "security_headers",
      "description": "MIDDLEWARE without permissions_policy middleware",
      "metadata": {
        "variable_name": "UNKNOWN",
        "env_var_name": "UNKNOWN",
        "original_fallback": "'default'",
        "context_analysis": {}
      },
      "jira_reference": {
        "ticket": "CSEC-30",
        "epic": "CSEC-5",
        "project": "Coco TestAI Security Remediation"
      },
      "fix_strategy": {
        "approach": "middleware_addition",
        "breaking_change": false,
        "description": "Add custom Django middleware that injects Permissions-Policy header\ninto all HTTP responses. This is a non-breaking addition that restricts\nbrowser features based on application needs.\n",
        "phases": [
          {
            "name": "detection",
            "duration_days": 0,
            "description": "Scan for missing Permissions-Policy configuration"
          },
          {
            "name": "middleware_creation",
            "duration_days": 0,
            "description": "Create custom permissions_policy middleware"
          },
          {
            "name": "configuration",
            "duration_days": 0,
            "description": "Add middleware to MIDDLEWARE list"
          },
          {
            "name": "testing",
            "duration_days": 1,
            "description": "Verify header appears in responses"
          }
        ]
      }
    }
  ],
  "summary": {
    "total_count": 2
  }
}