# Shield AI Backend - Quick Start Guide

## Installation

1. **Install dependencies:**
   ```bash
   pip install -r requirements.txt
   ```

2. **Verify installation:**
   ```bash
   python -m shield_ai --help
   ```

## Usage Examples

### 1. Scan a Codebase (Coco TestAI)

```bash
# Scan entire codebase
python -m shield_ai scan /path/to/coco-testai

# Scan for specific pattern (CSEC-22: WebSocket Error Sanitization)
python -m shield_ai scan /path/to/coco-testai --pattern csec_22_websocket_errors

# Scan for CSEC-23 (Bare except and DRF exception handler)
python -m shield_ai scan /path/to/coco-testai --pattern csec_23_bare_except

# Save findings to JSON
python -m shield_ai scan /path/to/coco-testai --output findings.json
```

### 2. Preview Fixes (Dry Run)

```bash
# Preview what changes will be made WITHOUT actually changing files
python -m shield_ai fix /path/to/coco-testai --dry-run
```

### 3. Apply Fixes

```bash
# Apply fixes for CSEC-22 (WebSocket errors)
python -m shield_ai fix /path/to/coco-testai --pattern csec_22_websocket_errors --framework django

# Apply fixes for CSEC-23 (Bare except)
python -m shield_ai fix /path/to/coco-testai --pattern csec_23_bare_except --framework django
```

**What happens:**
- âœ… Wraps vulnerable code with error handling utilities
- âœ… Generates helper functions and utilities
- âœ… Creates `SECURITY_UPDATES.md` documentation
- âœ… Creates backups of modified files (*.shield_ai_backup)

### 4. Generate Reports

```bash
# Text report
python -m shield_ai report /path/to/coco-testai

# Markdown report
python -m shield_ai report /path/to/coco-testai --format markdown --output SECURITY_REPORT.md

# JSON report
python -m shield_ai report /path/to/coco-testai --format json --output report.json
```

## Workflow for CSEC-22 (WebSocket Error Sanitization)

### Step 1: Scan
```bash
python -m shield_ai scan ../coco-testai --pattern csec_22_websocket_errors
```

**Expected output:**
```
ğŸ” Scanning ../coco-testai...
ğŸ“‹ Patterns to check: 1

  [!] Found X issues for csec_22_websocket_errors

ğŸ“Š SCAN RESULTS
Total findings: X

1. Unsanitized WebSocket Error Message (csec_22_websocket_errors)
   File: ../coco-testai/interpreter/consumers.py:45
   Severity: CRITICAL
   Code: await self.send(text_data=json.dumps({'error': str(e)}))...
```

### Step 2: Preview Fixes
```bash
python -m shield_ai fix ../coco-testai --pattern csec_22_websocket_errors --dry-run
```

### Step 3: Apply Fix

```bash
# Apply the fix (creates wrapper utility and sanitizes errors)
python -m shield_ai fix ../coco-testai --pattern csec_22_websocket_errors --framework django
```

**Files modified:**
- WebSocket consumer files - Error handling wrapped
- `interpreter/utils/websocket_errors.py` - Created with sanitization utility
- `SECURITY_UPDATES.md` - Documentation
- Backup files created (*.shield_ai_backup)

---

## Workflow for CSEC-23 (Bare Except & DRF Exception Handler)

### Step 1: Scan
```bash
python -m shield_ai scan ../coco-testai --pattern csec_23_bare_except
```

### Step 2: Preview Fixes
```bash
python -m shield_ai fix ../coco-testai --pattern csec_23_bare_except --dry-run
```

### Step 3: Apply Fix

```bash
# Apply fixes (context-aware exception type suggestions)
python -m shield_ai fix ../coco-testai --pattern csec_23_bare_except --framework django
```

**What Shield AI does:**
- Analyzes try block context (file operations, JSON parsing, etc.)
- Suggests specific exception types (e.g., JSONDecodeError, IOError)
- Replaces `except:` with appropriate exception type
- Adds custom DRF exception handler if missing

---

## File Structure After Running Shield AI

```
coco-testai/
â”œâ”€â”€ SECURITY_UPDATES.md                       # âœ¨ Generated by Shield AI
â”œâ”€â”€ interpreter/
â”‚   â”œâ”€â”€ consumers.py                          # âœ… Fixed by Shield AI
â”‚   â”œâ”€â”€ consumers.py.shield_ai_backup         # ğŸ’¾ Backup created
â”‚   â”œâ”€â”€ views.py                              # âœ… Fixed by Shield AI
â”‚   â”œâ”€â”€ views.py.shield_ai_backup             # ğŸ’¾ Backup created
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ websocket_errors.py               # âœ¨ Created by Shield AI
â””â”€â”€ ... (rest of codebase)
```

## Rollback

If something goes wrong:

```bash
# Restore from backup
cp interpreter/consumers.py.shield_ai_backup interpreter/consumers.py
cp interpreter/views.py.shield_ai_backup interpreter/views.py
```

## Testing After Fix

```bash
# Test the application
cd ../coco-testai
python manage.py check

# Run tests
python manage.py test
```

## Support

For issues or questions:
- GitHub: https://github.com/zaheerquodroid/Shield-AI-Backend
- Jira:
  - CSEC-22 (WebSocket Error Sanitization)
  - CSEC-23 (Bare Except & DRF Exception Handler)
